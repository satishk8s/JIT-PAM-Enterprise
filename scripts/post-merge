#!/bin/bash
# Git post-merge hook: runs after 'git pull'
# Restarts NPAMX backend so new code takes effect (no manual intervention)

REPO_DIR="$(cd "$(dirname "$0")/../.." && pwd)"
chmod +x "$REPO_DIR/backend/run-backend-on-ec2.sh" 2>/dev/null || true

if systemctl is-active --quiet npam-backend 2>/dev/null; then
    echo "[post-merge] Restarting npam-backend..."
    systemctl restart npam-backend
    echo "[post-merge] Backend restarted."
fi
